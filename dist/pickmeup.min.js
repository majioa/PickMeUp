/*
 Copyright (c) 2013-2017, Nazar Mokrynskyi
 @copyright Copyright (c) 2008-2009, Stefan Petre
 @license   MIT License, see license.txt
*/
(function(H,A){"function"===typeof define&&define.amd?define(A):"object"===typeof exports?module.exports=A():H.pickmeup=A()})(this,function(){function H(a,c,b){b=b||[];if(a instanceof Element)c.apply(c,[a].concat(b));else{var d;var e=a.length;for(d=0;d<e;++d)c.apply(c,[a[d]].concat(b))}}function A(a){var c;H(a,function(a){c=a.parentElement.removeChild(a)});return c}function L(a,c){do a=a.parentElement;while(a&&!D(a,c));return a}function D(a,c){return(a.matches||a.webkitMatchesSelector||a.msMatchesSelector).call(a,
c)}function l(a,c){return a&&a.classList.contains(c)}function h(a,c){a.classList.add(c)}function t(a,c,b,d){if(-1!==b.indexOf(" ")){b=b.split(" ");var e=b.length,g;for(g=0;g<e;++g)t(a,c,b[g],d)}else a.__pickmeup.events.push([c,b,d]),c.addEventListener(b,d)}function w(a,c,b,d){var e;if(b&&-1!==b.indexOf(" ")){var g=b.split(" ");var h=g.length;for(e=0;e<h;++e)w(a,c,g[e],d)}else for(g=a.__pickmeup.events,h=g.length,e=0;e<h;++e)c&&c!=g[e][0]||b&&b!=g[e][1]||d&&d!=g[e][2]||g[e][0].removeEventListener(g[e][1],
g[e][2])}function I(a,c,b,d){var e=a.querySelector(c+" \x3e ."+b);e||(e=a.querySelector(c).appendChild(d.instance_content_template([],b)));return e}function O(a){a=a.getBoundingClientRect();return{top:a.top+window.pageYOffset-document.documentElement.clientTop,left:a.left+window.pageXOffset-document.documentElement.clientLeft}}function E(a,c,b){var d=document.createEvent("Event");b&&(d.detail=b);d.initEvent("pickmeup-"+c,!1,!0);return a.dispatchEvent(d)}function M(a){a=new Date(a);for(var c=28,b=
a.getMonth();a.getMonth()==b;)++c,a.setDate(c);return c-1}function B(a,c){a.setDate(a.getDate()+c)}function r(a,c){var b=a.getDate();a.setDate(1);a.setMonth(a.getMonth()+c);a.setDate(Math.min(b,M(a)))}function x(a,c){var b=a.getDate();a.setDate(1);a.setFullYear(a.getFullYear()+c);a.setDate(Math.min(b,M(a)))}function P(a){var c=a.__pickmeup.element,b=a.__pickmeup.options,d=Math.floor(b.calendars/2),e=b.date,g=b.current,k=b.min?new Date(b.min):null,y=b.max?new Date(b.max):null;k&&(k.setDate(1),r(k,
1),B(k,-1));y&&(y.setDate(1),r(y,1),B(y,-1));for(var v=0;v<b.calendars;v++){var f=new Date(g);C(f);var n=Array.prototype.slice.call(c.querySelectorAll(".pmu-instance"))[v];var Q=I(c,".pmu-instance","pmu-years",b);var t=I(c,".pmu-instance","pmu-months",b);var m=I(c,".pmu-instance","pmu-days",b);if(l(c,"pmu-view-years")){x(f,12*(v-d));var q=f.getFullYear()-6+" - "+(f.getFullYear()+5)}else l(c,"pmu-view-months")?(x(f,v-d),q=f.getFullYear()):l(c,"pmu-view-days")&&(r(f,v-d),q=F(f,b.title_format,b.locales[b.locale]));
if(!u&&y){var u=new Date(f);b.select_day?r(u,b.calendars-1):b.select_month?x(u,b.calendars-1):x(u,12*(b.calendars-1));if(u>y){--v;r(g,-1);u=void 0;continue}}u=new Date(f);if(!z){var z=new Date(f);z.setDate(1);r(z,1);B(z,-1);if(k&&k>z){--v;r(g,1);z=void 0;continue}}n.querySelector(".pmu-month").textContent=q;var w=function(a){return"range"==b.mode&&a>=(new Date(e[0])).getFullYear()&&a<=(new Date(e[1])).getFullYear()||"multiple"==b.mode&&-1!==e.reduce(function(a,b){a.push((new Date(b)).getFullYear());
return a},[]).indexOf(a)||(new Date(e)).getFullYear()==a},A=function(a,c){var d=(new Date(e[0])).getFullYear(),f=(new Date(e[1])).getFullYear(),g=(new Date(e[0])).getMonth(),h=(new Date(e[1])).getMonth();return"range"==b.mode&&(a>d&&a<f||a>d&&a==f&&c<=h||a==d&&a<f&&c>=g||a==d&&a==f&&c>=g&&c<=h)||"multiple"==b.mode&&-1!==e.reduce(function(a,b){b=new Date(b);a.push(b.getFullYear()+"-"+b.getMonth());return a},[]).indexOf(a+"-"+c)||(new Date(e)).getFullYear()==a&&(new Date(e)).getMonth()==c};(function(){var a=
[],c=f.getFullYear()-6,d=(new Date(b.min)).getFullYear(),e=(new Date(b.max)).getFullYear(),g;for(g=0;12>g;++g){var m=c+g;var p=document.createElement("div");p.textContent=m;p.__pickmeup_year=m;b.min&&m<d||b.max&&m>e?h(p,"pmu-disabled"):w(m)&&h(p,"pmu-selected");a.push(p)}n.replaceChild(b.instance_content_template(a,"pmu-years"),Q)})();(function(){var a=[],c=f.getFullYear(),d=(new Date(b.min)).getFullYear(),e=(new Date(b.min)).getMonth(),g=(new Date(b.max)).getFullYear(),m=(new Date(b.max)).getMonth(),
p;for(p=0;12>p;++p){var k=document.createElement("div");k.textContent=b.locales[b.locale].monthsShort[p];k.__pickmeup_month=p;k.__pickmeup_year=c;b.min&&(c<d||p<e&&c==d)||b.max&&(c>g||p>m&&c>=g)?h(k,"pmu-disabled"):A(c,p)&&h(k,"pmu-selected");a.push(k)}n.replaceChild(b.instance_content_template(a,"pmu-months"),t)})();(function(){var a=[],c=f.getMonth(),d=new Date;b.today_offset&&d.setTime(d.getTime()+b.today_offset);var e=C(d);switch(typeof b.calendar_gap){case "function":var g=b.calendar_gap();break;
case "number":g=b.calendar_gap;break;default:g=0}(function(){f.setDate(1);var a=(f.getDay()-b.first_day-g)%7;B(f,-(a+(0>a?7:0)))})();for(d=0;42>d;++d){var k=document.createElement("div");k.textContent=f.getDate();k.__pickmeup_day=f.getDate();k.__pickmeup_month=f.getMonth();k.__pickmeup_year=f.getFullYear();c!=f.getMonth()&&h(k,"pmu-not-in-month");0==f.getDay()?h(k,"pmu-sunday"):6==f.getDay()&&h(k,"pmu-saturday");var p=b.render(new Date(f))||{};var l=f.valueOf();var y=b.min&&b.min>f||b.max&&b.max<
f;var v=b.date.valueOf()==l||b.date instanceof Array&&b.date.reduce(function(a,b){return a||l===b.valueOf()},!1)||"range"==b.mode&&l>=b.date[0]&&l<=b.date[1];p.disabled||!("disabled"in p)&&y?h(k,"pmu-disabled"):(p.selected||!("selected"in p)&&v)&&h(k,"pmu-selected");(p.today||e).setHours(0,0,0,0)==f.setHours(0,0,0,0)&&h(k,"pmu-today");p.class_name&&p.class_name.split(" ").forEach(h.bind(k,k));a.push(k);B(f,1)}n.replaceChild(b.instance_content_template(a,"pmu-days"),m)})()}z.setDate(1);u.setDate(1);
r(u,1);B(u,-1);d=c.querySelector(".pmu-prev");c=c.querySelector(".pmu-next");d&&(d.style.visibility=b.min&&b.min>=z?"hidden":"visible");c&&(c.style.visibility=b.max&&b.max<=u?"hidden":"visible");E(a,"fill")}function q(a,c){var b=c.format,d=c.separator,e=c.locales[c.locale];if(a instanceof Date||a instanceof Number)return C(new Date(a));if(!a)return C(new Date);if(a instanceof Array){a=a.slice();for(b=0;b<a.length;++b)a[b]=q(a[b],c);return a}d=a.split(d);if(1<d.length)return d.forEach(function(a,b,
d){d[b]=q(a.trim(),c)}),d;d=e.monthsShort.join(")(")+")("+e.months.join(")(");d=new RegExp("[^0-9a-zA-Z("+d+")]+");a=a.split(d);d=b.split(d);var g=new Date;for(b=0;b<a.length;b++)switch(d[b]){case "b":var k=e.monthsShort.indexOf(a[b]);break;case "B":k=e.months.indexOf(a[b]);break;case "d":case "e":var h=parseInt(a[b],10);break;case "m":k=parseInt(a[b],10)-1;break;case "Y":case "y":var l=parseInt(a[b],10);l+=100<l?0:29>l?2E3:1900;break;case "H":case "I":case "k":case "l":var f=parseInt(a[b],10);break;
case "P":case "p":/pm/i.test(a[b])&&12>f?f+=12:/am/i.test(a[b])&&12<=f&&(f-=12);break;case "M":var n=parseInt(a[b],10)}e=new Date(void 0===l?g.getFullYear():l,void 0===k?g.getMonth():k,void 0===h?g.getDate():h,void 0===f?g.getHours():f,void 0===n?g.getMinutes():n,0);isNaN(1*e)&&(e=new Date);return C(e)}function C(a){a.setHours(0,0,0,0);return a}function F(a,c,b){var d=a.getMonth(),e=a.getDate(),g=a.getFullYear(),k=a.getDay(),h=a.getHours(),l=12<=h,f=l?h-12:h;var n=new Date(a.getFullYear(),a.getMonth(),
a.getDate(),0,0,0);var q=new Date(a.getFullYear(),0,0,0,0,0);n=Math.floor((n-q)/24*36E5);0==f&&(f=12);q=a.getMinutes();var r=a.getSeconds();c=c.split("");for(var m,t=0;t<c.length;t++){m=c[t];switch(m){case "a":m=b.daysShort[k];break;case "A":m=b.days[k];break;case "b":m=b.monthsShort[d];break;case "B":m=b.months[d];break;case "C":m=1+Math.floor(g/100);break;case "d":m=10>e?"0"+e:e;break;case "e":m=e;break;case "H":m=10>h?"0"+h:h;break;case "I":m=10>f?"0"+f:f;break;case "j":m=100>n?10>n?"00"+n:"0"+
n:n;break;case "k":m=h;break;case "l":m=f;break;case "m":m=9>d?"0"+(1+d):1+d;break;case "M":m=10>q?"0"+q:q;break;case "p":case "P":m=l?"PM":"AM";break;case "s":m=Math.floor(a.getTime()/1E3);break;case "S":m=10>r?"0"+r:r;break;case "u":m=k+1;break;case "w":m=k;break;case "y":m=(""+g).substr(2,2);break;case "Y":m=g}c[t]=m}return c.join("")}function R(a,c){var b=a.__pickmeup.options,d;C(c);a:switch(b.mode){case "multiple":var e=c.valueOf();for(d=0;d<b.date.length;++d)if(b.date[d].valueOf()===e){b.date.splice(d,
1);break a}b.date.push(c);break;case "range":b.lastSel||(b.date[0]=c);c<=b.date[0]?(b.date[1]=b.date[0],b.date[0]=c):b.date[1]=c;b.lastSel=!b.lastSel;break;default:b.date=c.valueOf()}c=J(b);D(a,"input")&&(a.value="single"==b.mode?c.formatted_date:c.formatted_date.join(b.separator));E(a,"change",c);b.flat||!b.hide_on_select||"range"==b.mode&&b.lastSel||b.bound.hide()}function S(a,c){var b=c.target;l(b,"pmu-button")||(b=L(b,".pmu-button"));if(!l(b,"pmu-button")||l(b,"pmu-disabled"))return!1;c.preventDefault();
c.stopPropagation();a=a.__pickmeup.options;var d=L(b,".pmu-instance");c=d.parentElement;d=Array.prototype.slice.call(c.querySelectorAll(".pmu-instance")).indexOf(d);D(b.parentElement,"nav")?l(b,"pmu-month")?(r(a.current,d-Math.floor(a.calendars/2)),l(c,"pmu-view-years")?(a.current="single"!=a.mode?new Date(a.date[a.date.length-1]):new Date(a.date),a.select_day?(c.classList.remove("pmu-view-years"),h(c,"pmu-view-days")):a.select_month&&(c.classList.remove("pmu-view-years"),h(c,"pmu-view-months"))):
l(c,"pmu-view-months")?a.select_year?(c.classList.remove("pmu-view-months"),h(c,"pmu-view-years")):a.select_day&&(c.classList.remove("pmu-view-months"),h(c,"pmu-view-days")):l(c,"pmu-view-days")&&(a.select_month?(c.classList.remove("pmu-view-days"),h(c,"pmu-view-months")):a.select_year&&(c.classList.remove("pmu-view-days"),h(c,"pmu-view-years")))):l(b,"pmu-prev")?a.bound.prev(!1):a.bound.next(!1):l(c,"pmu-view-years")?(a.current.setFullYear(b.__pickmeup_year),a.select_month?(c.classList.remove("pmu-view-years"),
h(c,"pmu-view-months")):a.select_day?(c.classList.remove("pmu-view-years"),h(c,"pmu-view-days")):a.bound.update_date(a.current)):l(c,"pmu-view-months")?(a.current.setMonth(b.__pickmeup_month),a.current.setFullYear(b.__pickmeup_year),a.select_day?(c.classList.remove("pmu-view-months"),h(c,"pmu-view-days")):a.bound.update_date(a.current),r(a.current,Math.floor(a.calendars/2)-d)):(c=new Date(a.current),c.setYear(b.__pickmeup_year),c.setMonth(b.__pickmeup_month),c.setDate(b.__pickmeup_day),a.bound.update_date(c));
a.bound.fill();return!0}function J(a){if("single"==a.mode){var c=new Date(a.date);return{formatted_date:F(c,a.format,a.locales[a.locale]),date:c}}c={formatted_date:[],date:[]};a.date.forEach(function(b){b=new Date(b);c.formatted_date.push(F(b,a.format,a.locales[a.locale]));c.date.push(b)});return c}function K(a,c){var b=a.__pickmeup.element;if(c||l(b,"pmu-hidden")){var d=a.__pickmeup.options,e=O(a),g=window.pageXOffset,h=window.pageYOffset,q=document.documentElement.clientWidth,r=document.documentElement.clientHeight,
f=e.top,n=e.left;d.bound.fill();D(a,"input")&&((c=a.value)&&d.bound.set_date(c),t(a,a,"keydown",function(a){9==a.which&&d.bound.hide()}),d.lastSel=!1);if(E(a,"show")&&!d.flat){switch(d.position){case "top":f-=b.offsetHeight;break;case "left":n-=b.offsetWidth;break;case "right":n+=a.offsetWidth;break;case "bottom":f+=a.offsetHeight}f+b.offsetHeight>h+r&&(f=e.top-b.offsetHeight);f<h&&(f=e.top+a.offsetHeight);n+b.offsetWidth>g+q&&(n=e.left-b.offsetWidth);n<g&&(n=e.left+a.offsetWidth);b.style.top=f+"px";
b.style.left=n+"px";b.classList.remove("pmu-hidden");setTimeout(function(){t(a,document.documentElement,"click",d.bound.hide);t(a,window,"resize",d.bound.forced_show)})}}}function T(a,c){var b=a.__pickmeup.element,d=a.__pickmeup.options;c&&c.target&&(c.target==a||b.compareDocumentPosition(c.target)&16)||!E(a,"hide")||(h(b,"pmu-hidden"),w(a,document.documentElement,"click",d.bound.hide),w(a,window,"resize",d.bound.forced_show),d.lastSel=!1)}function U(a){var c=a.__pickmeup.options;w(a,document.documentElement,
"click",c.bound.hide);w(a,window,"resize",c.bound.forced_show);c.bound.forced_show()}function V(a){a=a.__pickmeup.options;"single"!=a.mode&&(a.date=[],a.lastSel=!1,a.bound.fill())}function W(a,c){"undefined"==typeof c&&(c=!0);var b=a.__pickmeup.element;a=a.__pickmeup.options;l(b,"pmu-view-years")?x(a.current,-12):l(b,"pmu-view-months")?x(a.current,-1):l(b,"pmu-view-days")&&r(a.current,-1);c&&a.bound.fill()}function X(a,c){"undefined"==typeof c&&(c=!0);var b=a.__pickmeup.element;a=a.__pickmeup.options;
l(b,"pmu-view-years")?x(a.current,12):l(b,"pmu-view-months")?x(a.current,1):l(b,"pmu-view-days")&&r(a.current,1);c&&a.bound.fill()}function Y(a,c){var b=a.__pickmeup.options;a=J(b);return"string"===typeof c?(a=a.date,a instanceof Date?F(a,c,b.locales[b.locale]):a.map(function(a){return F(a,c,b.locales[b.locale])})):a[c?"formatted_date":"date"]}function Z(a,c,b){var d=a.__pickmeup.options;if(!(c instanceof Array)||0<c.length)if(d.date=q(c,d),"single"!=d.mode)for(d.date instanceof Array?(d.date[0]=
d.date[0]||q(new Date,d),"range"==d.mode&&(d.date[1]=d.date[1]||q(d.date[0],d))):(d.date=[d.date],"range"==d.mode&&d.date.push(q(d.date[0],d))),c=0;c<d.date.length;++c)d.date[c]=N(d.date[c],d.min,d.max);else d.date instanceof Array&&(d.date=d.date[0]),d.date=N(d.date,d.min,d.max);else d.date=[];if(!d.select_day)if(d.date instanceof Array)for(c=0;c<d.date.length;++c)d.date[c].setDate(1);else d.date.setDate(1);if("multiple"==d.mode)for(c=0;c<d.date.length;++c)d.date.indexOf(d.date[c])!==c&&(d.date.splice(c,
1),--c);b?d.current=q(b,d):(b="single"===d.mode?d.date:d.date[d.date.length-1],d.current=b?new Date(b):new Date);d.current.setDate(1);d.bound.fill();D(a,"input")&&!1!==d.default_date&&(b=J(d),c=a.value,d="single"==d.mode?b.formatted_date:b.formatted_date.join(d.separator),c||E(a,"change",b),c!=d&&(a.value=d))}function aa(a){var c=a.__pickmeup.element;w(a);A(c);delete a.__pickmeup}function N(a,c,b){return c&&c>a?new Date(c):b&&b<a?new Date(b):a}function G(a,c){"string"==typeof a&&(a=document.querySelector(a));
if(!a)return null;if(!a.__pickmeup){var b;var d={};c=c||{};for(b in G.defaults)d[b]=b in c?c[b]:G.defaults[b];for(b in d)c=a.getAttribute("data-pmu-"+b),null!==c&&(d[b]=c);"days"!=d.view||d.select_day||(d.view="months");"months"!=d.view||d.select_month||(d.view="years");"years"!=d.view||d.select_year||(d.view="days");"days"!=d.view||d.select_day||(d.view="months");d.calendars=Math.max(1,parseInt(d.calendars,10)||1);d.mode=/single|multiple|range/.test(d.mode)?d.mode:"single";d.min&&(d.min=q(d.min,
d),d.select_day||d.min.setDate(1));d.max&&(d.max=q(d.max,d),d.select_day||d.max.setDate(1));c=document.createElement("div");a.__pickmeup={options:d,events:[],element:c};c.__pickmeup_target=a;h(c,"pickmeup");d.class_name&&h(c,d.class_name);d.bound={fill:P.bind(a,a),update_date:R.bind(a,a),click:S.bind(a,a),show:K.bind(a,a),forced_show:K.bind(a,a,!0),hide:T.bind(a,a),update:U.bind(a,a),clear:V.bind(a,a),prev:W.bind(a,a),next:X.bind(a,a),get_date:Y.bind(a,a),set_date:Z.bind(a,a),destroy:aa.bind(a,a)};
h(c,"pmu-view-"+d.view);var e=d.instance_template(d),g="";for(b=0;b<d.calendars;++b)g+=e;c.innerHTML=g;t(a,c,"click",d.bound.click);t(a,c,"onselectstart"in Element.prototype?"selectstart":"mousedown",function(a){a.preventDefault()});d.flat?(h(c,"pmu-flat"),a.appendChild(c)):(h(c,"pmu-hidden"),document.body.appendChild(c),t(a,a,"click",K.bind(a,a,!1)),t(a,a,"input",d.bound.update),t(a,a,"change",d.bound.update));d.bound.set_date(d.date,d.current)}d=a.__pickmeup.options;return{hide:d.bound.hide,show:d.bound.show,
clear:d.bound.clear,update:d.bound.update,prev:d.bound.prev,next:d.bound.next,get_date:d.bound.get_date,set_date:d.bound.set_date,destroy:d.bound.destroy}}G.defaults={current:null,date:new Date,default_date:new Date,flat:!1,first_day:1,prev:"\x26#9664;",next:"\x26#9654;",mode:"single",select_year:!0,select_month:!0,select_day:!0,view:"days",calendars:1,format:"d-m-Y",title_format:"B, Y",position:"bottom",class_name:"",separator:" - ",hide_on_select:!1,min:null,max:null,today_offset:null,render:function(){},
calendar_gap:null,locale:"en",locales:{en:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),daysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),daysMin:"Su Mo Tu We Th Fr Sa".split(" "),months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")}},instance_template:function(a){var c=a.locales[a.locale].daysMin.slice();a.first_day&&c.push(c.shift());return'\x3cdiv class\x3d"pmu-instance"\x3e\x3cnav\x3e\x3cdiv class\x3d"pmu-prev pmu-button"\x3e'+
a.prev+'\x3c/div\x3e\x3cdiv class\x3d"pmu-month pmu-button"\x3e\x3c/div\x3e\x3cdiv class\x3d"pmu-next pmu-button"\x3e'+a.next+'\x3c/div\x3e\x3c/nav\x3e\x3cnav class\x3d"pmu-day-of-week"\x3e\x3cdiv\x3e'+c.join("\x3c/div\x3e\x3cdiv\x3e")+"\x3c/div\x3e\x3c/nav\x3e\x3c/div\x3e"},instance_content_template:function(a,c){var b=document.createElement("div");h(b,c);for(c=0;c<a.length;++c)h(a[c],"pmu-button"),b.appendChild(a[c]);return b}};return G});